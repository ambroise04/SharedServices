function activate(n){n.addClass("active");n.addClass("grey");n.addClass("lighten-3");var t=n.children("a").first().attr("id");$("#target").attr("value",t)}function sendingMessage(){$("#message-box").val().trim()==""?toastr.error("Veuillez saisir votre message avant l'envoi."):sendMessage()}function sendMessage(){var n=$("#form-message").serialize();$.ajax({url:"Discussion/Discuss",type:"post",dataType:"json",data:n,success:function(n){n.status?sendSuccess(n.discussion,n.current):toastr.error(n.message)},error:function(){toastr.error("Une erreur a été rencontrée. Veuillez réessayer s'il vous plaît!")}})}function sendSuccess(n,t){var i="",r=$(".chat-content");i+=n.emitter==t?`
                        <li class="d-flex justify-content-end mb-2">
                            <div class="chat-body white p-3 z-depth-1 rounded">
                                <div class="header">
                                    <strong class="primary-font">${n.emitterName}</strong>
                                    <small class="pull-right text-muted"><i class="far fa-clock"></i> ${n.date}</small>
                                </div>
                                <hr class="w-100">
                                <p class="mb-0">
                                    ${n.message}
                                </p>
                            </div>
                        </li>
                    `:`
                        <li class="d-flex justify-content-start mb-2">
                            <div class="chat-body white p-3 ml-2 z-depth-1 rounded">
                                <div class="header">
                                    <strong class="primary-font">${n.emitterName}</strong>
                                    <small class="pull-right text-muted"><i class="far fa-clock"></i>${n.date}</small>
                                </div>
                                <hr class="w-100">
                                <p class="mb-0">
                                    ${n.message}
                                </p>
                            </div>
                        </li>
                    `;r.append(i)}function getDiscussion(n,t){$.ajax({type:"GET",url:"Discussion/Contact",data:{id:n},dataType:"json",success:function(n){n.status?fillContent(n.discussions,t):(stopLoading($("#col-chat")),console.log(n.message))},error:function(){stopLoading($("#col-chat"))}})}function fillContent(n,t){var i="",r=$(".chat-content");r.html("");$.each(n,function(n,r){i+=r.emitter==t?`
                        <li class="d-flex justify-content-end mb-2">
                            <div class="chat-body white p-3 z-depth-1 rounded">
                                <div class="header">
                                    <strong class="primary-font">${r.emitterName}</strong>
                                    <small class="pull-right text-muted"><i class="far fa-clock"></i> ${r.date}</small>
                                </div>
                                <hr class="w-100">
                                <p class="mb-0">
                                    ${r.message}
                                </p>
                            </div>
                        </li>
                    `:`
                        <li class="d-flex justify-content-start mb-2">
                            <div class="chat-body white p-3 ml-2 z-depth-1 rounded">
                                <div class="header">
                                    <strong class="primary-font">${r.emitterName}</strong>
                                    <small class="pull-right text-muted"><i class="far fa-clock"></i>${r.date}</small>
                                </div>
                                <hr class="w-100">
                                <p class="mb-0">
                                    ${r.message}
                                </p>
                            </div>
                        </li>
                    `});stopLoading($("#col-chat"));r.html(i)}$(".contact").on("click",function(){$(".contact, .active").removeClass("grey");$(".contact, .active").removeClass("lighten-3");$(".contact, .active").removeClass("active");activate($(this))});$(document).ready(function(){activate($(".friend-list").children("li").first());$(".contact a").on("click",function(){startLoading($("#col-chat"),"Chargement en cours...");getDiscussion(this.getAttribute("id"),this.getAttribute("current"))})});